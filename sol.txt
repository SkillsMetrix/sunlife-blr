package com.db;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.SQLException;

public class ConnectionTest {
	
	private String driver="com.mysql.jdbc.Driver";
	private String connString="jdbc:mysql://localhost/sunlifedb";
	private Connection conn;
	private String userName="root";
	private String password="root";
	public ConnectionTest(){
		try {
			Class.forName(driver);
		} catch (ClassNotFoundException e) {
			 
			e.printStackTrace();
		}
	}
	
	public Connection getConnection() {
		try {
			conn= DriverManager.getConnection(connString,userName,password);
		} catch (SQLException e) {
			 
			e.printStackTrace();
		}
		return conn;
		
	}

}

-------------------

package com.dao;

import com.exception.DaoException;
import com.model.Employee;

public interface EmployeeDAO {
	
	public Employee saveEmployee(Employee employee)throws DaoException;

}


-------------

package com.exception;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.SQLException;

import com.dao.EmployeeDAO;
import com.db.ConnectionTest;
import com.model.Employee;

public class EmployeeDaoImpl implements EmployeeDAO{
	
	String insertQuery="insert into employee values(?,?,?)";

	@Override
	public Employee saveEmployee(Employee employee) throws DaoException {
		try {
		ConnectionTest ct= new ConnectionTest();
		
		Connection conn= ct.getConnection();
		PreparedStatement pst= conn.prepareStatement(insertQuery);
		pst.setInt(1, employee.getEmpId());
		pst.setString(2, employee.getEmpName());
		pst.setString(3, employee.getEmpCity());
		pst.executeUpdate();
		}catch (SQLException e) {
			throw new DaoException("Employee not saved", e);
		}
		 
		return null;
	}

}


-------------

package com.exception;

public class DaoException  extends Exception{

	public DaoException(String message, Throwable cause) {
		super(message, cause);
		// TODO Auto-generated constructor stub
	}

	
}

------------

package com.client;

import com.dao.EmployeeDAO;
import com.exception.DaoException;
import com.exception.EmployeeDaoImpl;
import com.model.Employee;

public class Client {
	public static void main(String[] args) {
		EmployeeDAO dao= new EmployeeDaoImpl();
		Employee emp= new Employee(102, "Shruti", "pune");
		try {
			dao.saveEmployee(emp);
		} catch (DaoException e) {
			System.out.println(e.getMessage());
		
		}
	}

}

